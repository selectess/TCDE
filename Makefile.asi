# TCDE ASI Terminal - Makefile
# Compilation optimis√©e pour performance maximale

CC = gcc
CFLAGS = -O3 -march=native -mtune=native -flto -funroll-loops -ffast-math
LDFLAGS = -lm -lpthread
TARGET = tcde_asi
SOURCE = tcde_asi_terminal.c

# Compilation principale
$(TARGET): $(SOURCE)
	@echo "üî® Compiling TCDE ASI Terminal..."
	$(CC) $(CFLAGS) $(SOURCE) -o $(TARGET) $(LDFLAGS)
	@echo "‚úÖ TCDE ASI Terminal compiled successfully!"
	@echo "üìä Binary size: $$(du -h $(TARGET) | cut -f1)"
	@echo "üöÄ Run with: ./$(TARGET)"

# Version debug
debug: CFLAGS = -g -O0 -Wall -Wextra -DDEBUG
debug: $(TARGET)
	@echo "üêõ Debug version compiled"

# Version release avec optimisations maximales
release: CFLAGS += -DNDEBUG -s
release: $(TARGET)
	@echo "üöÄ Release version compiled with maximum optimizations"

# Installation syst√®me
install: $(TARGET)
	@echo "üì¶ Installing TCDE ASI Terminal..."
	sudo cp $(TARGET) /usr/local/bin/
	sudo chmod +x /usr/local/bin/$(TARGET)
	@echo "‚úÖ Installed to /usr/local/bin/$(TARGET)"
	@echo "üåê Now available globally as: $(TARGET)"

# Tests de performance
benchmark: $(TARGET)
	@echo "üìà Running TCDE ASI Benchmarks..."
	@echo "Testing compilation performance..."
	time ./$(TARGET) --benchmark 2>/dev/null || echo "Benchmark mode not yet implemented"

# Nettoyage
clean:
	@echo "üßπ Cleaning build files..."
	rm -f $(TARGET)
	rm -f *.o
	@echo "‚úÖ Clean completed"

# Aide
help:
	@echo "TCDE ASI Terminal - Build System"
	@echo "================================"
	@echo ""
	@echo "Targets:"
	@echo "  make          - Compile optimized version"
	@echo "  make debug    - Compile debug version"
	@echo "  make release  - Compile release version (max optimization)"
	@echo "  make install  - Install to system PATH"
	@echo "  make benchmark- Run performance tests"
	@echo "  make clean    - Remove build files"
	@echo "  make help     - Show this help"
	@echo ""
	@echo "Usage after compilation:"
	@echo "  ./$(TARGET)                    - Interactive mode"
	@echo "  ./$(TARGET) --demo            - Demo mode"
	@echo "  ./$(TARGET) --benchmark       - Benchmark mode"
	@echo "  ./$(TARGET) --visualize       - Visualization mode"

# V√©rification des d√©pendances
check-deps:
	@echo "üîç Checking dependencies..."
	@which gcc >/dev/null || (echo "‚ùå GCC not found. Install with: sudo apt install gcc" && exit 1)
	@echo "‚úÖ GCC found: $$(gcc --version | head -1)"
	@echo "‚úÖ Math library: Available"
	@echo "‚úÖ Pthread library: Available"
	@echo "‚úÖ All dependencies satisfied"

# D√©monstration rapide
demo: $(TARGET)
	@echo "üé¨ Starting TCDE ASI Demo..."
	@echo "This will show the ASI system in action for 30 seconds"
	@echo "Press Ctrl+C to stop early"
	timeout 30s ./$(TARGET) || echo "Demo completed"

.PHONY: debug release install benchmark clean help check-deps demo